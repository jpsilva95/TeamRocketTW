javascript:(function(_0xBEEF){'use strict';const _0xTM=typeof GM_info!=='undefined'||typeof GM_xmlhttpRequest!=='undefined';if(!_0xTM){if(window.__twBLLoaded)return;window.__twBLLoaded=true;}const _0xS={ae:'tw_auto_send_enabled',at:'tw_auto_send_time',wh:'tw_discord_webhook',sm:'tw_daily_sent_marker',im:'tw_daily_intent_marker',pm:'tw_daily_sending_marker',ip:'Send already in progress on this page',ok:'Auto-send success',bt:'Mystery Inc Bot'};const _0xN=(()=>{let x=0;for(let i=0;i<96;i++)x^=(Math.random()*i)|0;return x===x;})();class _0xA71F{constructor(){this.checkVersion();this.initUI&&this.initUI();this.initAutoScheduler();}checkVersion(){const v='4.1';const k='tw_script_version';const last=localStorage.getItem(k);if(last!==v){localStorage.setItem(k,v);localStorage.removeItem(_0xS.sm);localStorage.removeItem(_0xS.pm);localStorage.removeItem(_0xS.im);}}initAutoScheduler(){const enabled=localStorage.getItem(_0xS.ae)==='true';const time=localStorage.getItem(_0xS.at);const hook=localStorage.getItem(_0xS.wh);if(!enabled||!hook)return;if(!_0xTM){if(window.__twSchedulerActive)return;window.__twSchedulerActive=true;}const now=new Date();const delay=(60-now.getSeconds())*1000;setTimeout(()=>{this.checkAutoSend(time,hook);setInterval(()=>this.checkAutoSend(time,hook),6e4);},delay);}async checkAutoSend(target,hook){const now=new Date();const cur=String(now.getHours()).padStart(2,'0')+':'+String(now.getMinutes()).padStart(2,'0');if(cur!==target)return;const key=now.toDateString()+'_'+target;if(localStorage.getItem(_0xS.sm)===key)return;const nonce=Date.now()+Math.random();localStorage.setItem(_0xS.im,JSON.stringify({key,nonce}));await new Promise(r=>setTimeout(r,200));const intent=JSON.parse(localStorage.getItem(_0xS.im)||'{}');if(intent.nonce!==nonce)return;localStorage.setItem(_0xS.pm,JSON.stringify({key,nonce}));await new Promise(r=>setTimeout(r,200));const sending=JSON.parse(localStorage.getItem(_0xS.pm)||'{}');if(sending.nonce!==nonce)return;localStorage.setItem(_0xS.sm,key);try{const stats=await this.gatherStats();await this.sendToDiscord(hook,stats);console.log(_0xS.ok);}catch(e){localStorage.removeItem(_0xS.sm);console.error(e);}finally{localStorage.removeItem(_0xS.im);localStorage.removeItem(_0xS.pm);}}async sendToDiscord(hook,stats){if(!_0xTM){if(window.__twSending)throw new Error(_0xS.ip);window.__twSending=true;}const payload=JSON.stringify({embeds:[{title:'ðŸ“Š Tribal Wars Daily Report',color:5814783,timestamp:new Date().toISOString(),footer:{text:_0xS.bt}}]});try{await new Promise((res,rej)=>{GM_xmlhttpRequest({method:'POST',url:hook,headers:{'Content-Type':'application/json'},data:payload,onload:r=>r.status<300?res():rej(r),onerror:rej});});}finally{if(!_0xTM)window.__twSending=false;}}async gatherStats(){return{world:'UNKNOWN',playerName:'PLAYER'};}}if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',()=>new _0xA71F());}else{new _0xA71F();}})(Date.now());
